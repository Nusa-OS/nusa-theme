#!/bin/bash
set -e

# --- System Branding ---
cat <<EOF > /etc/os-release
PRETTY_NAME="Nusa OS 1.2.2"
NAME="Nusa OS"
VERSION_ID="1.2.2"
VERSION="1.2.2 Beta"
ID=nusa
ID_LIKE=ubuntu
EOF

# --- GNOME GSchema Overrides (Hardcode Identity) ---
mkdir -p /usr/share/glib-2.0/schemas/
cat <<EOF > /usr/share/glib-2.0/schemas/99_nusa_identity.gschema.override
[org.gnome.desktop.interface]
gtk-theme='Arc-Darker'
icon-theme='Papirus'
cursor-theme='Bibata-Modern-Classic'
font-name='Inter 10'
document-font-name='Inter 10'
monospace-font-name='Fira Code 10'

[org.gnome.desktop.background]
picture-uri='file:///usr/share/backgrounds/nusa/default.jpg'
picture-options='zoom'

[org.gnome.shell.extensions.dash-to-dock]
background-opacity=0.8
custom-theme-shrink=true
EOF

# Compile schemas agar terbaca sistem
glib-compile-schemas /usr/share/glib-2.0/schemas/

# --- GTK 3/4 Force Gold Color ---
mkdir -p /etc/skel/.config/gtk-3.0/
cat <<EOF > /etc/skel/.config/gtk-3.0/gtk.css
@define-color selected_bg_color #D4AF37;
@define-color selected_fg_color #1A1A1A;
@define-color accent_color #D4AF37;
EOF
mkdir -p /etc/skel/.config/gtk-4.0/
cp /etc/skel/.config/gtk-3.0/gtk.css /etc/skel/.config/gtk-4.0/gtk.css

exit 0
